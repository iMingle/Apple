<!doctype html>
<html lang="zh">
<head>
	<meta charset="UTF-8" />
	<title>Document</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script type="text/javascript" src="../../../scripts/jquery/jquery-1.11.1.js"></script>
</head>
<body>
	<!-- 创造规律 -->
	<ul>
		<li>
			<a href="javascript:void(0);">主页</a><a href="javascript:void(0);"> del</a>
			<ul>
				<li>
					<a href="javascript:void(0);">主页1</a><a href="javascript:void(0);"> del</a>
				</li>
				<li><a href="javascript:void(0);">主页2</a><a href="javascript:void(0);"> del</a></li>
				<li>
					<a href="javascript:void(0);">主页3</a><a href="javascript:void(0);"> del</a>
					<ul>
						<li>
							<a href="javascript:void(0);">主页1</a><a href="javascript:void(0);"> del</a>
						</li>
						<li><a href="javascript:void(0);">主页2</a><a href="javascript:void(0);"> del</a></li>
						<li><a href="javascript:void(0);">主页3</a><a href="javascript:void(0);"> del</a></li>
					</ul>
				</li>
			</ul>
		</li>
		<li><a href="javascript:void(0);">系统</a><a href="javascript:void(0);"> del</a></li>
		<li><a href="javascript:void(0);">油箱</a><a href="javascript:void(0);"> del</a></li>
	</ul>
	
	<div class="container"></div>
</body>
</html>

<script type="text/javascript">
	function Menu(configs) {
		this.text = configs.text;
		this.opened = false;
		this.view = $("<li></li>");
		$('<a href="javascript:void(0);"></a>').text(this.text).appendTo(this.view);
		this.click();
		this.remove();
		if(configs.children) {
			this.createChild(configs.children);
		}
	}
	
	Menu.prototype.click = function() {
		var that = this;
		this.view.find(">a:first").on("click", function(event) {
			//
			that.open();
			alert(that.text);
		});
	};
	
	$.extend(Menu.prototype, {
		
		createChild : function(configs) {
			this.opened = true;
			this.ul = $("<ul></ul>").appendTo(this.view);
			for(var i=0; i < configs.length; i++) {
				var child = new Menu(configs[i]);
				child.view.appendTo(this.ul);
			}
		},
		
		remove : function() {
			var _this = this;
			this.delIcon = $('<a href="javascript:void(0);"></a>').text("del").appendTo(this.view);
			this.delIcon.on("click", function() {
				_this.view.remove();
				_this.delIcon.remove();
			});
		},
		
		append : function(el) {
			this.view.appendTo(el);
		},
		
		open : function() {
			if(this.opened) {
				this.ul.hide();
				this.opened = false;
			} else {
				this.ul.show();
				this.opened = true;
			}
		}
		
	});

	$(document).ready(function() {
		
		
		$("a").each(function() {
			this.opened = true;
		});
		$("a").on("click", function(event) {
			//首先判断是否是叶子节点
			//如果不是
			var child = $(this).next("ul");
			if(child.size() > 0) {
				if(this.opened) {
					child.hide();
					this.opened = false;
				} else {
					child.show();
					this.opened = true;
				}
			} else {
				alert($(this).text());
			}
		});
		
		var menu = new Menu({text : "菜单", children : [{
			text : "菜单1"
		},{
			text : "菜单2",
			children : [{
					text : "菜单1"
				},{
					text : "菜单2"
				}]
		}]});
		menu.append(".container");
	});
</script>